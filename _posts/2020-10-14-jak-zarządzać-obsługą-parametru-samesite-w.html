---
layout: post
title: Jak zarządzać obsługą parametru SameSite w ciasteczkach od strony przeglądarek
  internetowych?
date: '2020-10-14T16:16:56+02:00'
tags:
- chromium
- edge
- firefox
- cookies
- samesite
tumblr_url: https://blog.pfe.academy/post/631961043603783680/jak-zarz%C4%85dza%C4%87-obs%C5%82ug%C4%85-parametru-samesite-w
---
<p>Na początku tego roku w zwięzły sposób opisałem, <a href="https://blog.pfe.academy/post/190462924468/o-co-chodzi-w-samesite-w-ciasteczkach">o co chodzi w parametrze SameSite w ciasteczkach</a>, a także o tym, <a href="https://blog.pfe.academy/post/190492750608/jak-konfigurowa%C4%87-atrybut-samesite-w-ciasteczkach">jak skonfigurować atrybut SameSite w serwerach aplikacji webowych</a>. </p><p>W zasadzie wszystkie przeglądarki uwzględniły zmiany w sierpniu. Jednak w wielu wypadkach dostawcy nie zaimplementowali tej funkcjonalności po stronie serwerów aplikacyjnych. Jeśli w waszym środowisku macie taką mieszankę zgodnych i niezgodnych rozwiązań, musicie zastanowić się, jak to obsłużyć po stronie klienckiej. W okresie zmian możecie zastosować obejście w postaci zaaplikowania odpowiednich ustawień po stronie klienta dla wszystkich lub wybranych witryn. </p><p>Proponuję posłużyć się ustawieniami zasad grup środowiska domenowego lub profilami ustawień Intune. </p><!-- more --><p>W przeglądarkach opartych na silniku Chromium (przynajmniej) do 14 lipca 2021 roku, mają być udostępniane polityki ustawień zgodności wstecznej (Cookie Legacy SameSite Policies). </p><figure data-orig-width="1027" data-orig-height="449" class="tmblr-full"><img src="https://64.media.tumblr.com/140ce1a09c13b9253830ff408411e9c4/b4890af0ee60e676-e0/s540x810/df86e4812d81785b855e9826f060c3d898717f1c.png" alt="image" data-orig-width="1027" data-orig-height="449"/></figure><p>Jak je zaaplikować na komputerach w przedsiębiorstwie? Prawie zawsze pierwszym wyborem będzie dystrybucja odpowiednich ustawień za pomocą ustawień zasad grup. </p><p>W tym celu należy pobrać właściwe dla zarządzanej przeglądarki szablony administracyjne:</p><p>Microsoft Edge — do pobrania z witryny <a href="https://www.microsoft.com/en-us/edge/business/download">Edge for Business</a>. </p><p>Google Chrome — do pobrania z witryny <a href="https://chromeenterprise.google/browser/download/#download">Chrome browser for enterprise</a>.</p><p>Mozilla Firefox — do pobrania z witryny  <a href="https://github.com/mozilla/policy-templates/releases/tag/v2.3">Policy templates for Firefox</a>.</p><p>Pobrane szablony należy zainstalować w folderze PolicyDefinition <a href="https://docs.microsoft.com/en-us/troubleshoot/windows-client/group-policy/create-and-manage-central-store">magazynu szablonów (najlepiej centralnego)</a>. Nie ma sensu instalować niczego „na zapas”. Jeśli w danej chwili nie używacie i nie ma potrzeby konfiguracji ustawień dla jakiegoś programu, nie instalujecie też jego szablonów. </p><figure data-orig-width="943" data-orig-height="384" class="tmblr-full"><img src="https://64.media.tumblr.com/d31c7e80213b493499bc5bd6bb315ee1/b4890af0ee60e676-54/s540x810/af6c67a2caa3d684fb9ae600f3c63726816cde1b.png" alt="image" data-orig-width="943" data-orig-height="384"/></figure><p>W Edge i Chrome można użyć dwóch różnych opcji:<br/></p><p><b><a href="https://docs.microsoft.com/en-us/deployedge/microsoft-edge-policies#legacysamesitecookiebehaviorenabled">LegacySameSiteCookieBehaviorEnabled</a></b> — Umożliwia globalne przywrócenie poprzedniego trybu obsługi SameSite dla plików cookie. Powoduje to, że pliki cookie, które nie określają atrybutu SameSite, są traktowane tak, jakby były ustawione z parametrem 

„SameSite = None”. Jednocześnie usuwa wymóg, aby pliki cookie „SameSite = None” nosiły atrybut „Secure” i pomija porównanie schematów podczas oceny, czy dwie witryny to ta sama witryna.</p><figure data-orig-width="1016" data-orig-height="654" class="tmblr-full"><img src="https://64.media.tumblr.com/98137e1f6c14e0a13788fd0496a53454/b4890af0ee60e676-3c/s540x810/bccefecf2ce8debde15b959c7632e066e8f5f718.png" alt="image" data-orig-width="1016" data-orig-height="654"/></figure><p>Ustawienie może przyjąć dwie wartości:</p><p>DefaultToLegacySameSiteCookieBehavior = 1 </p><p>Przywróć starsze zachowanie SameSite dla plików cookie we wszystkich witrynach.</p><p>DefaultToSameSiteByDefaultCookieBehavior = 2</p><p>Użyj domyślnego zachowania SameSite dla plików cookie we wszystkich witrynach.</p><p><b><a href="https://docs.microsoft.com/en-us/deployedge/microsoft-edge-policies#legacysamesitecookiebehaviorenabledfordomainlist">LegacySameSiteCookieBehaviorEnabledForDomainList</a> </b>— Analogiczne ustawienie, ale aplikowane do witryn działających w określonych domenach. Zdecydowanie lepsza opcja, zawężająca stosowanie poprzednich ustawień do 

 adresów

wybranych aplikacji webowych. </p><figure data-orig-width="1177" data-orig-height="780" class="tmblr-full"><img src="https://64.media.tumblr.com/284c9cc36f073b0e3a68a9fedbc8daab/b4890af0ee60e676-ac/s540x810/6ecd3b870f5d8ec7f09a302427f94457752cc3f9.png" alt="image" data-orig-width="1177" data-orig-height="780"/></figure><p>Ustawienia można skonfigurować w GPMC w „Administrative Templates/Microsoft Edge/Content settings” pod nazwami „Enable default legacy SameSite cookie behavior setting&quot; oraz „Revert to legacy SameSite behavior for cookies on specified sites”. </p><p>Technicznie ustawienia są mapowane na klucze rejestru 

LegacySameSiteCookieBehaviorEnabled w    SOFTWARE\Policies\Microsoft\Edge oraz 1 i kolejne pozycje z listy w    SOFTWARE\Policies\Microsoft\Edge\LegacySameSiteCookieBehaviorEnabledForDomainList.</p><p>Obecnie, Firefox nie dostarcza analogicznych ustawień w szablonach zasad grup. Ewentualne zmiany należy zaaplikować inną metodą (mozilla.cfg, policies.json, autoconfig) lub bezpośrednio w edytorze konfiguracji. </p><figure data-orig-width="887" data-orig-height="405" class="tmblr-full"><img src="https://64.media.tumblr.com/fa9a97dea0c44745f15f19735039df2c/b4890af0ee60e676-22/s540x810/2ce8759084c959e227dbe9d24ec4bbc428e9b773.png" alt="image" data-orig-width="887" data-orig-height="405"/></figure>
